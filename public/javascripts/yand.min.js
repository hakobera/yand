function Yand(){var a=this;a.search=$("#searchField"),a.indexList=$("#indexList"),a.results=$("#results"),a.categories=$(".category",indexList),a.keys={enter:13,escape:27,up:38,down:40,left:37,right:39,array:[13,27,37,38,39,40]},a.isMobile=!1}Yand.prototype.init=function(){var a=this;a.initView(),a.bindEvents(),a.mobilify(),a.setupHistory(),a.loadFirstPage()},Yand.prototype.initView=function(){self.categories.each(function(){$(this).addClass("close")})},Yand.prototype.bindEvents=function(){var a=this;a.search.keyup(function(b){$.inArray(b.keyCode,keys.array)!==-1?a.handleKey(keys,b.keyCode):a.searchIndex(search,indexList,results)}).focus(),$("a",a.indexList).live("click",function(b){b.preventDefault(),$("li",indexList).removeClass("selected"),$(this).parent().addClass("selected"),a.linkOpen($(this))}),$("a",a.results).live("click",function(b){b.preventDefault(),$("li",a.results).removeClass("selected"),$(this).parent().addClass("selected"),a.linkOpen($(this))}),$("span:first",a.categories).toggle(function(){a.listOpen($(this).closest(".category"))},function(){a.listClose($(this).closest(".category"))})},Yand.prototype.mobilify=function(){var a=this,b=navigator.userAgent;if(b.indexOf("Mobile")!==-1&&b.indexOf("Safari")){a.isMobile=!0;var c=$(parent.window).innerHeight()-30;$("#navigation").css({height:c,"overflow-y":"scroll","overflow-x":"hidden"}),setTimeout(function(){window.scrollTo(0,1)},0)}},Yand.prototype.setupHistory=function(){var a=this;Modernizr.history&&(window.parent.onpopstate=function(b){var c=b.state;a.linkOpen(c,!1)})},Yand.prototype.loadFirstPage=function(){var a=this,b=window.parent.location,c=b.search,d=b.hash,e=c.match(/\?q=([^&]+)/),f=c.match(/\?p=([^&]+)/);if(e){e=decodeURIComponent(e[1]).replace(/\+/g," ");if(e.length>0){a.search.val(e),a.searchIndex(search);var g=$("li > a",a.results);g.length>0&&a.linkOpen($(g[0]))}}else f&&f[1]?a.linkOpen(f[1]+"#"+d):a.linkOpen("top.html",!1)},Yand.prototype.handleKey=function(a,b){var c=this;if(c.results.is(":visible")){var d=$(".selected:visible");if(d.length){b==a.up&&d.prev().length&&d.removeClass("selected").prev().addClass("selected"),b==a.down&&d.next().length&&d.removeClass("selected").next().addClass("selected");if(b==a.enter){var e=d.find("a:first").attr("href");c.linkOpen(d.find("a:first"))}b==a.right&&c.listOpen(d),b==a.left&&c.listClose(d)}else b==a.down&&(d=$("li:first",results),d.addClass("selected"))}},Yand.prototype.searchIndex=function(a){var b=this,c=a.val();c.length?(b.results.html("").show(),b.indexList.hide(),c=c.toLowerCase(),$(".searchable",b.indexList).each(function(){var a=$(this),d=a.text(),e=d.toLowerCase().indexOf(c);if(e!=-1&&b.results.text().indexOf(d)===-1){var f=$("<li>");f.append(a.parent().parent().find("a:first").clone()),f.highlight(c),b.results.append(f)}}),$(".selected",b.indexList).removeClass("selected"),$("li:first",b.results).addClass("selected")):(b.results.hide(),b.indexList.show())},Yand.prototype.listOpen=function(a){a.removeClass("close").children("ul").show()},Yand.prototype.listClose=function(a){a.addClass("close").children("ul").hide()},Yand.prototype.linkOpen=function(a,b){var c=this,d=typeof a=="string"?a:a.attr("href"),b=b!=undefined?b:!0,e=parent.docwin,f=e.document;$("#doc",$(f)).load(d,function(){var a=$(this);if(c.isMobile){var f=$(parent.window).innerHeight();a.css({height:f,"overflow-y":"scroll","overflow-x":"hidden"})}var g=d.lastIndexOf("#");if(g!==-1){var h=d.substring(g),i=h.replace(/\./g,"\\."),j=a.find(i).position().top+10;c.isMobile?(a.scrollTop(0),a.scrollTop(j)):e.scrollTo(0,j),Modernizr.history&&b&&window.parent.history.pushState(d,null,"?p="+d)}})},$(function(){var a=$("#navigation").load("navigation.html",function(){(new Yand).init()})});